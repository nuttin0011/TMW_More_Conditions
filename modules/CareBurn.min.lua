-- Care Burn 1.7b Icon
if not IROVar then IROVar={}end;if not IROVar.InstanceName then IROVar.InstanceName=GetInstanceInfo()end;if not IROVar.fspec and not IROVar.finstanceName then IROVar.finstanceName=CreateFrame("Frame")IROVar.finstanceName:RegisterEvent("ZONE_CHANGED_NEW_AREA")IROVar.finstanceName:SetScript("OnEvent",function()IROVar.InstanceName=GetInstanceInfo()end)end;if not IROVar.MobListForBurn then IROVar.MobListForBurn={["Mists of Tirna Scithe"]={["Ingra Maloch"]=[[return TMW.CNDT.Env.AuraDur("target", "droman's wrath", "HARMFUL")>0]],["Droman Oulfarran"]=false},["De Other Side"]={["Mueh'zala"]=[[return (UnitHealth("target")/UnitHealthMax("target"))<0.2]],["Shattered Visage"]=true,["Millhouse Manastorm"]=false},["Halls of Atonement"]={["Echelon"]=[[return UnitCastingInfo("target")=="Stone Call"]],["Undying Stonefiend"]=[[return TMW.CNDT.Env.AuraDur("target", "stone form", "HELPFUL")==0]]},["The Necrotic Wake"]={["Stitchflesh's Creation"]=false,["Zolramus Siphoner"]=false},["Spires of Ascension"]={["Oryphrion"]=[[return TMW.CNDT.Env.AuraDur("target", "drained", "HARMFUL")>10]]}}IROVar.MobListForBurn.encounterID=nil;IROVar.MobListForBurn.encounterStart=GetTime()if not IROVar.MobListForBurn.event then IROVar.MobListForBurn.encounterStart=0;IROVar.MobListForBurn.eventFunc=function(a,b,c,d,e,f,g)if b=="ENCOUNTER_START"then IROVar.MobListForBurn.encounterID=c;IROVar.MobListForBurn.encounterStart=GetTime()elseif b=="ENCOUNTER_END"then IROVar.MobListForBurn.encounterID=nil end end end;if not IROVar.MobListForBurn.frame then IROVar.MobListForBurn.frame=CreateFrame("Frame")IROVar.MobListForBurn.frame:RegisterEvent("ENCOUNTER_START")IROVar.MobListForBurn.frame:RegisterEvent("ENCOUNTER_END")IROVar.MobListForBurn.frame:SetScript("OnEvent",IROVar.MobListForBurn.eventFunc)end;IROVar.CareBurn=function(h)if IROVar.MobListForBurn.encounterID and not UnitExists("boss1")then IROVar.MobListForBurn.encounterID=nil end;h=h or""local c=IROVar.MobListForBurn.encounterID or 0;if IROVar.MobListForBurn[c]then if IROVar.MobListForBurn[c][h]~=nil then if IROVar.MobListForBurn[c][h]==false then return false end;return IROVar.MobListForBurn[c][h]==true and true or loadstring(IROVar.MobListForBurn[c][h])()else if IROVar.MobListForBurn[c][0]==false then return false end;return IROVar.MobListForBurn[c][0]==true and true or loadstring(IROVar.MobListForBurn[c][0])()end end;local i="target"if not IROVar.MobListForBurn[IROVar.InstanceName]then return true end;local j=UnitName(i)if not j then return true end;if IROVar.MobListForBurn[IROVar.InstanceName][j]==nil then return true end;local k=j..h;if IROVar.MobListForBurn[IROVar.InstanceName][k]~=nil then j=k end;if IROVar.MobListForBurn[IROVar.InstanceName][j]==false then return false end;return IROVar.MobListForBurn[IROVar.InstanceName][j]==true and true or loadstring(IROVar.MobListForBurn[IROVar.InstanceName][j])()end end